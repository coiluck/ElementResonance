<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>自然共鳴 | ローグライクカードゲーム</title>
  <link rel="stylesheet" href="./css/top.css">
  <link rel="stylesheet" href="./css/effect.css">
  <link rel="stylesheet" href="./css/gallery.css">
  <link rel="stylesheet" href="./css/rules.css">
  <link rel="stylesheet" href="./css/game.css">
  <link rel="stylesheet" href="./css/game-result.css">
  <link rel="stylesheet" href="./css/game-middle.css">
  <link rel="stylesheet" href="./css/middle-deck.css">
  <link rel="stylesheet" href="./css/middle-synthesis.css">
  <link rel="stylesheet" href="./css/game-finish.css">
  <link rel="stylesheet" href="./css/message.css">
  <link rel="icon" href="./images/favicon.ico">
</head>
<body>

  <!-- bodyの背景画像 -->
  <div class="body-background-wrapper">
    <img src="./images/background_ruins.avif" alt="神秘的な背景" class="body-background-image">
    <div class="body-overlay"></div>
  </div>

  <div id="modal-top" class="modal">
    <!-- 背景画像 -->
    <div class="top-background-wrapper">
      <img src="./images/background_ruins.avif" alt="神秘的な背景" class="top-background-image">
      <div class="top-overlay"></div>
    </div>
    <!-- コンテンツ -->
    <div class="top-container">
      <header class="top-header">
        <h1 class="top-main-title">自然共鳴</h1>
        <p class="top-sub-title"><span>五つの自然属性、紡がれる戦術。</span><span>運命はカードに刻まれる</span></p>
        <!-- ルールボタン -->
        <button class="top-rules-button">
          <span class="top-rules-icon">📜</span>
          <span class="top-rules-text">ルール</span>
        </button>
      </header>
      <!-- ボタン -->
      <div class="top-button-group">
        <button class="top-button top-card-list-button">
          <span class="top-button-text">カード図鑑を見る</span>
          <span class="top-button-subtext">戦略の扉を開く</span>
        </button>
        <button class="top-button top-start-game-button">
          <span class="top-button-text">新たな旅を始める</span>
          <span class="top-button-subtext">未知の運命へ</span>
        </button>
        <button class="top-button top-continue-game-button">
          <span class="top-button-text">前回の冒険から</span>
          <span class="top-button-subtext">物語を紡ぎ直す</span>
        </button>
      </div>
    </div>
  </div>

  <div id="modal-gallery" class="modal">
    <div class="gallery-background-wrapper">
      <img src="./images/background_ruins.avif" alt="神秘的な背景" class="gallery-background-image">
      <div class="gallery-overlay"></div>
    </div>
    <div class="gallery-container">
      <main class="gallery-card-list-area">
        <nav class="gallery-attribute-tabs">
          <button class="gallery-tab-button gallery-active" data-attribute-index="0">虚</button>
          <button class="gallery-tab-button" data-attribute-index="1">霧</button>
          <button class="gallery-tab-button" data-attribute-index="2">燐</button>
          <button class="gallery-tab-button" data-attribute-index="3">暁</button>
          <button class="gallery-tab-button" data-attribute-index="4">砂</button>
        </nav>
        <div class="gallery-attribute-content-scroll-container">
            <div class="gallery-attribute-content-wrapper">
              <div class="gallery-attribute-page" id="gallery-cards-虚">
                <section class="gallery-card-type-section">
                  <h3>通常タイプ</h3>
                  <div class="gallery-cards-grid">
                    <div class="gallery-card-placeholder" data-gallery-card-id="虚-通常-1">虚 通常1</div>
                    <div class="gallery-card-placeholder" data-gallery-card-id="虚-通常-2">虚 通常2</div>
                    <div class="gallery-card-placeholder" data-gallery-card-id="虚-通常-3">虚 通常3</div>
                  </div>
                </section>
                <section class="gallery-card-type-section">
                  <h3>コンボタイプ</h3>
                  <div class="gallery-cards-grid">
                    <div class="gallery-card-placeholder" data-gallery-card-id="虚-コンボ-1">虚 コンボ1</div>
                    <div class="gallery-card-placeholder" data-gallery-card-id="虚-コンボ-2">虚 コンボ2</div>
                    <div class="gallery-card-placeholder" data-gallery-card-id="虚-コンボ-3">虚 コンボ3</div>
                  </div>
                </section>
                <section class="gallery-card-type-section">
                  <h3>刻印タイプ</h3>
                  <div class="gallery-cards-grid">
                    <div class="gallery-card-placeholder" data-gallery-card-id="虚-刻印-1">虚 刻印1</div>
                    <div class="gallery-card-placeholder" data-gallery-card-id="虚-刻印-2">虚 刻印2</div>
                    <div class="gallery-card-placeholder" data-gallery-card-id="虚-刻印-3">虚 刻印3</div>
                  </div>
                </section>
              </div>
              <div class="gallery-attribute-page" id="gallery-cards-霧">
                <section class="gallery-card-type-section"><h3>通常タイプ</h3><div class="gallery-cards-grid"><div class="gallery-card-placeholder" data-gallery-card-id="霧-通常-1">霧 通常1</div><div class="gallery-card-placeholder" data-gallery-card-id="霧-通常-2">霧 通常2</div><div class="gallery-card-placeholder" data-gallery-card-id="霧-通常-3">霧 通常3</div></div></section><section class="gallery-card-type-section"><h3>コンボタイプ</h3><div class="gallery-cards-grid"><div class="gallery-card-placeholder" data-gallery-card-id="霧-コンボ-1">霧 コンボ1</div><div class="gallery-card-placeholder" data-gallery-card-id="霧-コンボ-2">霧 コンボ2</div><div class="gallery-card-placeholder" data-gallery-card-id="霧-コンボ-3">霧 コンボ3</div></div></section><section class="gallery-card-type-section"><h3>刻印タイプ</h3><div class="gallery-cards-grid"><div class="gallery-card-placeholder" data-gallery-card-id="霧-刻印-1">霧 刻印1</div><div class="gallery-card-placeholder" data-gallery-card-id="霧-刻印-2">霧 刻印2</div><div class="gallery-card-placeholder" data-gallery-card-id="霧-刻印-3">霧 刻印3</div></div></section>
              </div>
              <div class="gallery-attribute-page" id="gallery-cards-燐">
                <section class="gallery-card-type-section"><h3>通常タイプ</h3><div class="gallery-cards-grid"><div class="gallery-card-placeholder" data-gallery-card-id="燐-通常-1">燐 通常1</div><div class="gallery-card-placeholder" data-gallery-card-id="燐-通常-2">燐 通常2</div><div class="gallery-card-placeholder" data-gallery-card-id="燐-通常-3">燐 通常3</div></div></section><section class="gallery-card-type-section"><h3>コンボタイプ</h3><div class="gallery-cards-grid"><div class="gallery-card-placeholder" data-gallery-card-id="燐-コンボ-1">燐 コンボ1</div><div class="gallery-card-placeholder" data-gallery-card-id="燐-コンボ-2">燐 コンボ2</div><div class="gallery-card-placeholder" data-gallery-card-id="燐-コンボ-3">燐 コンボ3</div></div></section><section class="gallery-card-type-section"><h3>刻印タイプ</h3><div class="gallery-cards-grid"><div class="gallery-card-placeholder" data-gallery-card-id="燐-刻印-1">燐 刻印1</div><div class="gallery-card-placeholder" data-gallery-card-id="燐-刻印-2">燐 刻印2</div><div class="gallery-card-placeholder" data-gallery-card-id="燐-刻印-3">燐 刻印3</div></div></section>
              </div>
              <div class="gallery-attribute-page" id="gallery-cards-暁">
                <section class="gallery-card-type-section"><h3>通常タイプ</h3><div class="gallery-cards-grid"><div class="gallery-card-placeholder" data-gallery-card-id="暁-通常-1">暁 通常1</div><div class="gallery-card-placeholder" data-gallery-card-id="暁-通常-2">暁 通常2</div><div class="gallery-card-placeholder" data-gallery-card-id="暁-通常-3">暁 通常3</div></div></section><section class="gallery-card-type-section"><h3>コンボタイプ</h3><div class="gallery-cards-grid"><div class="gallery-card-placeholder" data-gallery-card-id="暁-コンボ-1">暁 コンボ1</div><div class="gallery-card-placeholder" data-gallery-card-id="暁-コンボ-2">暁 コンボ2</div><div class="gallery-card-placeholder" data-gallery-card-id="暁-コンボ-3">暁 コンボ3</div></div></section><section class="gallery-card-type-section"><h3>刻印タイプ</h3><div class="gallery-cards-grid"><div class="gallery-card-placeholder" data-gallery-card-id="暁-刻印-1">暁 刻印1</div><div class="gallery-card-placeholder" data-gallery-card-id="暁-刻印-2">暁 刻印2</div><div class="gallery-card-placeholder" data-gallery-card-id="暁-刻印-3">暁 刻印3</div></div></section>
              </div>
              <div class="gallery-attribute-page" id="gallery-cards-砂">
                <section class="gallery-card-type-section"><h3>通常タイプ</h3><div class="gallery-cards-grid"><div class="gallery-card-placeholder" data-gallery-card-id="砂-通常-1">砂 通常1</div><div class="gallery-card-placeholder" data-gallery-card-id="砂-通常-2">砂 通常2</div><div class="gallery-card-placeholder" data-gallery-card-id="砂-通常-3">砂 通常3</div></div></section><section class="gallery-card-type-section"><h3>コンボタイプ</h3><div class="gallery-cards-grid"><div class="gallery-card-placeholder" data-gallery-card-id="砂-コンボ-1">砂 コンボ1</div><div class="gallery-card-placeholder" data-gallery-card-id="砂-コンボ-2">砂 コンボ2</div><div class="gallery-card-placeholder" data-gallery-card-id="砂-コンボ-3">砂 コンボ3</div></div></section><section class="gallery-card-type-section"><h3>刻印タイプ</h3><div class="gallery-cards-grid"><div class="gallery-card-placeholder" data-gallery-card-id="砂-刻印-1">砂 刻印1</div><div class="gallery-card-placeholder" data-gallery-card-id="砂-刻印-2">砂 刻印2</div><div class="gallery-card-placeholder" data-gallery-card-id="砂-刻印-3">砂 刻印3</div></div></section>
              </div>
            </div>
        </div>
      </main>

      <aside class="gallery-card-detail-area">
        <div class="gallery-enlarged-card-placeholder">
          拡大カード
        </div>
        <div class="gallery-card-effect">
          <h4>カード効果</h4>
          <p id="gallery-card-effect-text">ここに選択したカードの効果が表示されます。</p>
        </div>
      </aside>
    </div>
    <button id="gallery-close-button">Topへ</button>
  </div>

  <div id="modal-rules" class="modal">
    <div class="rules-background-wrapper">
      <img src="./images/background_ruins.avif" alt="神秘的な背景" class="rules-background-image">
      <div class="rules-overlay"></div>
    </div>
    <div class="rules-container">
      <p class="rules-title">ルール</p>
      <p class="rules-text">
        <strong>勝利条件／敗北条件</strong><br>
        敵のHPを0にすると勝利となります。プレイヤーのHPが0になると敗北となります。<br><br>
        
        <strong>デッキ構成とカード置き場</strong><br>
        ・戦闘に持ち込めるカードを「デッキ」と呼び、戦闘開始時は10枚です。<br>
        ・戦闘中、1ターンに手札からプレイできるカードの上限枚数を「カード置き場」と呼び、戦闘開始時は3枚です。<br>
        ・ボスを倒すとデッキ枚数やカード置き場の上限が増加します。<br>
        ・カードにはレアリティ（1～3）が設定されており、再使用までのクールタイムが変動します（レアリティ1→3ターン、2→4ターン、3→5ターン）。<br><br>
        
        <strong>ラウンド構成</strong><br>
        ・全9ラウンド制です。<br>
        ・ボスラウンド: 3、6、9の3ラウンド。ボスは強力な攻撃を行い、特定のHPトリガーで行動が変化します。<br>
        ・各ラウンド開始時に、プレイヤーは最大HPの20%を回復します。<br><br>
        
        <strong>エッセンス獲得と合成システム</strong><br>
        ・敵を倒すと「エッセンス」を獲得します。<br>
        　- 獲得できるエッセンスは「自然属性エッセンス」「カード属性エッセンス」「振り分けポイント」の3種類です。<br>
        ・ラウンド間では、獲得した3種類の要素を合成して新しいカードを生成できます。<br>
        　- 自然属性エッセンス: 虚、霧、燐、暁、砂の5属性が存在します。<br>
        　- カード属性エッセンス: 通常、コンボ、刻印の3タイプがあります。<br>
        　- 振り分けポイント：レアリティの決定に使用します。<br>
        ・合成画面でデッキ調整を行い、次ラウンドに向けてデッキの強化・最適化を行います。<br><br>

        <strong>刻印システム</strong><br>
        ・一部のカードにより、刻印というバフ・デバフが自然属性に応じて味方や敵に付与されます。<br>
        ・刻印はカードの発動条件のためのものであり、単体では効果を発揮しません。<br>
        ・刻印は刻印タイプのレアリティ3のカードで効果を発揮します。<br>
        ・各自然属性につき、3つまでしか刻印をためることはできません。<br><br>
        
        <strong>敵の行動と強化</strong><br>
        ・敵は固定デッキを持たず、各敵ごとに用意された行動パターン（スキルセット）を繰り返します。<br>
        ・各ラウンドごとにステータス（HP、使用カードの効果量）が上昇します。<br>
        ・ボス戦ではHPトリガーによって行動が変化します。<br><br>
        
        <strong>ターンの流れ</strong><br>
        
        1. ターン開始フェイズ<br>
           　プレイヤーのカード再使用クールタイムが1ターン分短縮されます。<br><br>
        2. プレイヤーフェイズ<br>
           　手札からカードを「カード置き場」の上限までプレイできます。<br>
           　カードを上限までプレイするか、使用可能なカードをすべてプレイすると、「ターン進行」ボタンが表示されます。<br>
           　カードを使用すると、指定された対象にダメージやバフ、回復、刻印付与などの効果を発揮します。<br><br>
        3. 敵フェイズ<br>
           　敵は固有の行動パターンに従って行動し、プレイヤーへ攻撃などを行います。<br><br>
        4. ターン終了フェイズ<br>
           　ターン持続効果の解決を行います。<br><br><br>
        
        以上がゲームのルールです。エッセンスを集めて合成し、デッキを強化しながら、自然属性やカード属性の組み合わせを駆使して挑戦してみてください。
      </p>
    </div>
    <button id="rules-close-button">Topへ</button>
  </div>

  <div id="modal-game" class="modal">
    <div class="game-container">
      <div class="game-main">
        <div class="game-main-characters">
          <div class="game-main-characters-player">
            <div class="game-main-characters-player-image"><img src="" alt="プレイヤー"></div>
            <p class="game-main-characters-player-name">プレイヤー</p>
            <div class="game-main-characters-player-status-container">
              <div class="game-main-characters-player-status-hp-bar">
                <div class="hp-bar-inner"></div>
              </div>
              <div class="game-main-characters-player-status-hp">HP: 30/30</div>
            </div>
            <div class="game-main-characters-player-status-buff"></div>
          </div>
          <div class="game-main-characters-enemy">
            <div class="game-main-characters-enemy-image"><img src="" alt="敵"></div>
            <p class="game-main-characters-enemy-name">これは見えないはず</p>
            <div class="game-main-characters-enemy-status-container">
              <div class="game-main-characters-enemy-status-hp-bar">
                <div class="hp-bar-inner"></div>
              </div>
              <div class="game-main-characters-enemy-status-hp">HP: 30/30</div>
            </div>
            <div class="game-main-characters-enemy-status-buff"></div>
          </div>
        </div>
        <div class="game-main-HoldCards">
          <p class="game-main-label">プレイヤー</p>
          <div class="game-main-HoldCards-player"></div>
          <p class="game-main-label">敵</p>
          <div class="game-main-HoldCards-enemy"></div>
        </div>
      </div>
      <div class="game-cards">これは見えないはず</div>
    </div>
  </div>

  <div id="modal-result" class="modal">
    <div class="result-title">Stage Clear</div>
    <div class="reward-container"></div>
  </div>

  <div id="modal-game-middle" class="modal">
    <!-- 必要なのはデッキ・開始・合成だけ? -->
    <!-- あとラウンド表示とトップへか -->
    <div class="middle-header">
      <button id="middle-close-button">&lt;&lt; Topへ</button>
      <p class="middle-round-display">Round: <span class="middle-round-number">1</span> / 15</p>
    </div>
    <div class="middle-container">
      <div class="middle-game-start-container">
        <button id="middle-game-start-button">開始</button>
      </div>
      <div class="middle-button-container">
        <button class="middle-deck middle-deck-first">デッキ</button>
        <button class="middle-synthesis">合成</button>
      </div>
    </div>
  </div>

  <div id="modal-game-middle-deck" class="modal">
    <!-- デッキの選択画面 -->
    <div class="middleDeck-header">
      <button id="middleDeck-close-button">&lt;&lt; 開始画面へ</button>
      <p class="middleDeck-round-display">Round: <span class="middle-round-number">1</span> / 15</p>
    </div>
    <div class="middleDeck-container">
      <div class="middleDeck-status">
        <div class="middleDeck-info-item">
          <div class="middleDeck-info-number" id="middleDeck-totalCards">30</div>
          <div class="middleDeck-info-label">所持カード　</div>
        </div>
        <div class="middleDeck-info-item">
          <div class="middleDeck-info-number" id="middleDeck-selectedCards">0/10</div>
          <div class="middleDeck-info-label">選択済み</div>
        </div>
        <div class="middleDeck-info-item">
          <div class="middleDeck-info-number" id="middleDeck-permanentCards">0/0</div>
          <div class="middleDeck-info-label">永続スロット</div>
        </div>
      </div>
      <div class="middleDeck-select-area">
        <nav class="middleDeck-tabs">
          <button class="middleDeck-tab-button middleDeck-active" data-attribute-index="0">デッキ</button>
          <button class="middleDeck-tab-button" data-attribute-index="1">永続スロット</button>
        </nav>
        <div class="middleDeck-tab-content">
          <div class="middleDeck-tab-panel">
            <div class="middleDeck-cards-grid" id="middleDeck-deckList">
              カードは動的に生成。この文字は見えないはず
            </div>
          </div>
          <div class="middleDeck-tab-panel">
            <div class="middleDeck-cards-grid" id="middleDeck-permanentList">
              <div id="middleDeck-permanent-holder"></div>
              <div id="middleDeck-permanent-cards"></div>
            </div>
          </div>
        </div>
      </div>
      <button id="middleDeck-confirm">選択を確定</button>
    </div>
  </div>

  <div id="modal-game-middle-synthesis" class="modal">
    <!-- 合成画面 -->
    <div class="middleSynthesis-header">
      <button id="middleSynthesis-close-button">&lt;&lt; 開始画面へ</button>
      <p class="middleSynthesis-round-display">Round: <span class="middle-round-number">1</span> / 15</p>
    </div>
    <div class="middleSynthesis-container">
      <p class="middleSynthesis-label">属性</p>
      <div class="middleSynthesis-attribute">
        <div class="middleSynthesis-attribute-item" data-attribute="虚"><img src="./images/attribute_icon/hollow.avif" alt="虚の属性"><p style="--after-content: '初期値';">虚</p></div>
        <div class="middleSynthesis-attribute-item" data-attribute="霧"><img src="./images/attribute_icon/fog.avif" alt="霧の属性"><p style="--after-content: '初期値';">霧</p></div>
        <div class="middleSynthesis-attribute-item" data-attribute="燐"><img src="./images/attribute_icon/lumina.avif" alt="燐の属性"><p style="--after-content: '初期値';">燐</p></div>
        <div class="middleSynthesis-attribute-item" data-attribute="暁"><img src="./images/attribute_icon/daybreak.avif" alt="暁の属性"><p style="--after-content: '初期値';">暁</p></div>
        <div class="middleSynthesis-attribute-item" data-attribute="砂"><img src="./images/attribute_icon/sand.avif" alt="砂の属性"><p style="--after-content: '初期値';">砂</p></div>
      </div>
      <div class="middleSynthesis-content">
        <div class="middleSynthesis-responsive-zone">
          <div class="middleSynthesis-cardtype">
            <p class="middleSynthesis-label">カードタイプ</p>
            <div class="middleSynthesis-cardtype-item-container">
              <div class="middleSynthesis-cardtype-item" style="--after-content: '初期値';">通常</div>
              <div class="middleSynthesis-cardtype-item" style="--after-content: '初期値';">コンボ</div>
              <div class="middleSynthesis-cardtype-item" style="--after-content: '初期値';">刻印</div>
            </div>
          </div>
          <div class="middleSynthesis-rarity">
            <p class="middleSynthesis-label" id="middleSynthesis-rarity-label" style="--after-content: '初期値';">レアリティ</p>
            <div class="middleSynthesis-rarity-item-container">
              <div class="middleSynthesis-rarity-item">1</div>
              <div class="middleSynthesis-rarity-item">2</div>
              <div class="middleSynthesis-rarity-item">3</div>
            </div>
          </div>
        </div>
        <div class="middleSynthesis-preview">
          <p class="middleSynthesis-label">プレビュー</p>
          <img src="./images/synthesis-text-preview.avif" alt="カードプレビュー">
        </div>
      </div>
      <button class="middleSynthesis-confirm">合成</button>
    </div>
  </div>

  <div id="modal-game-finish" class="modal"></div>

  <div id="message-box"></div>

  <script src="./js/top.js" type="module"></script>
  <script src="./js/gallery.js" type="module"></script>
  <script src="./js/start-game.js" type="module"></script>
  <script src="./js/middle-deck.js" type="module"></script>
  <script src="./js/middle-synthesis.js"></script>
  <!-- この下のやつはexport用だから書かなくていいのか？（よくわからんから残しておくが...） -->
  <script src="./js/end-game.js" type="module"></script>
  <script src="./js/message.js" type="module"></script>
  <script src="./js/game-player-animation.js" type="module"></script>
  <script src="./js/game-prosses-cards.js" type="module"></script>
  <script src="./js/game-process-enemy.js" type="module"></script>
  <script src="./js/game-buff-update.js" type="module"></script>
  <script src="./js/music.js" type="module"></script>
  <script src="./js/result-reward.js" type="module"></script>
  <script>
    function addAttribute(index, count) {
      window.essence.attributes[index].count += count;
    }
    function addCardType(index, count) {
      window.essence.cardTypes[index].count += count;
    }
    function addRarity(rarity) {
      window.essence.rarity = rarity;
    }
    function addAllCards() {
      for (let i = 1; i <= 45; i++) {
        window.cards.push(i);
      }
    }
  </script>
</body>
</html>